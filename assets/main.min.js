function toggleTheme(){const e=document.documentElement,t="dark"===e.getAttribute("data-theme")?"light":"dark";e.setAttribute("data-theme",t),localStorage.setItem("theme",t),document.getElementById("theme-icon").textContent="dark"===t?"ðŸŒ™":"â˜€ï¸"}const savedTheme=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",savedTheme),document.getElementById("theme-icon").textContent="dark"===savedTheme?"ðŸŒ™":"â˜€ï¸";const revealElements=document.querySelectorAll(".scroll-reveal");if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("revealed"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -100px 0px"});revealElements.forEach(t=>e.observe(t))}else{const e=()=>{revealElements.forEach(e=>{e.getBoundingClientRect().top<window.innerHeight-100&&e.classList.add("revealed")})};window.addEventListener("scroll",e,{passive:!0}),e()}function getCurrentBlogLanguage(){const e=localStorage.getItem("blog_language_preference");if(e)return e;return(navigator.language||navigator.userLanguage).toLowerCase().startsWith("it")?"it":"en"}function toggleBlogLanguage(){const e="it"===getCurrentBlogLanguage()?"en":"it";localStorage.setItem("blog_language_preference",e),updateLanguageToggleUI(e),loadLatestBlogPosts(e)}function updateLanguageToggleUI(e){const t=document.getElementById("lang-icon"),n=document.getElementById("lang-text");"it"===e?(t.textContent="ðŸ‡®ðŸ‡¹",n.textContent="IT"):(t.textContent="ðŸ‡¬ðŸ‡§",n.textContent="EN")}async function loadLatestBlogPosts(e=null){const t=e||getCurrentBlogLanguage();updateLanguageToggleUI(t);const n=`blog_posts_${t}_`+(new Date).toDateString(),o=localStorage.getItem(n);if(o)try{return void renderBlogPosts(JSON.parse(o),t)}catch(e){console.warn("Failed to parse cached blog posts:",e),localStorage.removeItem(n)}try{const e="en"===t?"/AndreaBozzo/blog/en/index.json":"/AndreaBozzo/blog/index.json",o=await fetch(e);if(!o.ok)throw new Error("Failed to fetch blog posts");const a=await o.json();localStorage.setItem(n,JSON.stringify(a)),renderBlogPosts(a,t)}catch(e){console.error("Failed to load blog posts:",e),showBlogError(t)}}function renderBlogPosts(e,t){const n=document.getElementById("blog-grid");if(!n||!e||0===e.length)return void showBlogError(t);const o=e.slice(0,2);n.innerHTML=o.map(e=>{const n=formatBlogDate(e.date||"",t),o=extractTags(e);return`\n            <a href="${e.permalink}" class="blog-card" style="text-decoration: none; color: inherit;">\n                <div class="blog-date">${escapeHtml(n)}</div>\n                <div class="blog-title">${escapeHtml(e.title)}</div>\n                <div class="blog-summary">${escapeHtml(e.summary)}</div>\n                <div class="blog-tags">\n                    ${o.map(e=>`<span class="blog-tag">${escapeHtml(e)}</span>`).join("")}\n                </div>\n            </a>\n        `}).join("")}function showBlogError(e){const t="it"===e?"Nessun articolo disponibile al momento.":"No articles available at the moment.";document.getElementById("blog-grid").innerHTML=`\n        <div class="blog-card" style="text-align: center; padding: 3rem;">\n            <div class="blog-title">${t}</div>\n        </div>\n    `}function formatBlogDate(e,t){if(!e)return"it"===t?"Recente":"Recent";try{const n=new Date(e),o={year:"numeric",month:"long",day:"numeric"},a="it"===t?"it-IT":"en-US";return n.toLocaleDateString(a,o)}catch(t){return e}}function extractTags(e){if(e.tags&&Array.isArray(e.tags))return e.tags.slice(0,4);const t=[],n=(e.content||e.title||"").toLowerCase();return n.includes("rust")&&t.push("Rust"),n.includes("data")&&n.includes("engineer")&&t.push("Data Engineering"),n.includes("streaming")&&t.push("Streaming"),n.includes("iceberg")&&t.push("Apache Iceberg"),t.slice(0,4)}function escapeHtml(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,e=>t[e])}"serviceWorker"in navigator&&"localhost"!==window.location.hostname&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/AndreaBozzo/sw.js").then(e=>{console.log("âœ… Service Worker registered:",e.scope),setInterval(()=>{e.update()},36e5)}).catch(e=>{console.log("âŒ Service Worker registration failed:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("ðŸ”„ Service Worker updated, reloading..."),window.location.reload()})}),document.addEventListener("DOMContentLoaded",function(){const e=()=>loadLatestBlogPosts();"requestIdleCallback"in window?requestIdleCallback(e):setTimeout(e,100)});