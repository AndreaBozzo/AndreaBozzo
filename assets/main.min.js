function toggleTheme(){const e=document.documentElement,t="dark"===e.getAttribute("data-theme")?"light":"dark";e.setAttribute("data-theme",t),localStorage.setItem("theme",t),document.getElementById("theme-icon").textContent="dark"===t?"ðŸŒ™":"â˜€ï¸"}const savedTheme=localStorage.getItem("theme")||"dark";if(document.documentElement.setAttribute("data-theme",savedTheme),document.getElementById("theme-icon").textContent="dark"===savedTheme?"ðŸŒ™":"â˜€ï¸",window.innerWidth>768){const e=document.querySelector(".cursor"),t=document.querySelector(".cursor-follower");document.addEventListener("mousemove",n=>{e.style.left=n.clientX+"px",e.style.top=n.clientY+"px",setTimeout(()=>{t.style.left=n.clientX+"px",t.style.top=n.clientY+"px"},100)}),document.querySelectorAll("a, button, .btn, .tech-item, .blog-card, .project-card").forEach(t=>{t.addEventListener("mouseenter",()=>e.classList.add("active")),t.addEventListener("mouseleave",()=>e.classList.remove("active"))})}const canvas=document.getElementById("particles-canvas"),ctx=canvas.getContext("2d",{alpha:!0,desynchronized:!0});canvas.width=window.innerWidth,canvas.height=window.innerHeight;const particles=[],particleCount=window.innerWidth<768?30:45;class Particle{constructor(){this.x=Math.random()*canvas.width,this.y=Math.random()*canvas.height,this.vx=.5*(Math.random()-.5),this.vy=.5*(Math.random()-.5),this.radius=2*Math.random()+1}update(){this.x+=this.vx,this.y+=this.vy,(this.x<0||this.x>canvas.width)&&(this.vx*=-1),(this.y<0||this.y>canvas.height)&&(this.vy*=-1)}draw(){ctx.fillStyle="rgba(88, 166, 255, 0.3)",ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI),ctx.fill()}}for(let e=0;e<particleCount;e++)particles.push(new Particle);let lastFrameTime=0;const targetFPS=60,frameInterval=1e3/60,maxDistance=120,maxDistanceSquared=14400;let isCanvasVisible=!0,animationId=null;const prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;function animateParticles(e){if(isCanvasVisible&&!prefersReducedMotion)if(e-lastFrameTime<frameInterval)animationId=requestAnimationFrame(animateParticles);else{lastFrameTime=e,ctx.clearRect(0,0,canvas.width,canvas.height),particles.forEach(e=>e.update()),ctx.lineWidth=.5;for(let e=0;e<particles.length;e++){const t=particles[e];let n=0;const a=5;for(let o=e+1;o<particles.length&&n<a;o++){const e=particles[o],a=t.x-e.x,r=t.y-e.y;if(Math.abs(a)>120||Math.abs(r)>120)continue;const i=a*a+r*r;if(i<14400){const a=.2*(1-Math.sqrt(i)/120);ctx.strokeStyle=`rgba(88, 166, 255, ${a})`,ctx.beginPath(),ctx.moveTo(t.x,t.y),ctx.lineTo(e.x,e.y),ctx.stroke(),n++}}}ctx.fillStyle="rgba(88, 166, 255, 0.3)",particles.forEach(e=>e.draw()),animationId=requestAnimationFrame(animateParticles)}}function startAnimation(){!isCanvasVisible||animationId||prefersReducedMotion||(lastFrameTime=performance.now(),animationId=requestAnimationFrame(animateParticles))}function stopAnimation(){animationId&&(cancelAnimationFrame(animationId),animationId=null)}if("IntersectionObserver"in window){new IntersectionObserver(e=>{e.forEach(e=>{isCanvasVisible=e.isIntersecting,isCanvasVisible?startAnimation():stopAnimation()})},{threshold:.01}).observe(canvas)}let resizeTimeout;prefersReducedMotion||startAnimation(),window.addEventListener("resize",()=>{clearTimeout(resizeTimeout),resizeTimeout=setTimeout(()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight},150)});const revealElements=document.querySelectorAll(".scroll-reveal");if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("revealed"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -100px 0px"});revealElements.forEach(t=>e.observe(t))}else{const e=()=>{revealElements.forEach(e=>{e.getBoundingClientRect().top<window.innerHeight-100&&e.classList.add("revealed")})};window.addEventListener("scroll",e,{passive:!0}),e()}async function loadGitHubMetrics(){const e="github_metrics",t="github_metrics_timestamp",n=localStorage.getItem(e),a=localStorage.getItem(t),o=Date.now(),r=a?o-parseInt(a):1/0;if(n&&r<864e5)try{return void updateMetrics(JSON.parse(n))}catch(n){console.warn("Failed to parse cached GitHub metrics:",n),localStorage.removeItem(e),localStorage.removeItem(t)}try{const n="AndreaBozzo",[a,r]=await Promise.all([fetch(`https://api.github.com/users/${n}`),fetch(`https://api.github.com/users/${n}/repos?per_page=100&sort=updated`)]),[i,s]=await Promise.all([a.json(),r.json()]),c=s.reduce((e,t)=>e+t.stargazers_count,0),l=i.public_repos,d={commits:Math.max(50*l,500),repos:l,stars:c};localStorage.setItem(e,JSON.stringify(d)),localStorage.setItem(t,o.toString()),updateMetrics(d)}catch(e){console.log("GitHub API error:",e),updateMetrics({commits:500,repos:15,stars:50})}}function updateMetrics(e){const t=[e.commits,e.repos,e.stars];["commits-count","repos-count","stars-count"].forEach((e,n)=>{document.getElementById(e).classList.remove("loading"),animateCounter(e,t[n])})}function animateCounter(e,t){const n=document.getElementById(e),a=t/40;let o=0;const r=setInterval(()=>{o+=a,o>=t&&(o=t,clearInterval(r)),n.textContent=Math.floor(o).toLocaleString()},50)}const hero=document.querySelector(".hero-content");let parallaxEnabled=!1,ticking=!1,lastMouseX=0,lastMouseY=0;function updateParallax(){if(!parallaxEnabled||window.innerWidth<=768)return;const e=(window.innerWidth/2-lastMouseX)/100,t=(window.innerHeight/2-lastMouseY)/100,n=Math.max(-5,Math.min(5,e)),a=Math.max(-5,Math.min(5,t));hero.style.transform=`rotateY(${n}deg) rotateX(${a}deg)`,ticking=!1}function getCurrentBlogLanguage(){const e=localStorage.getItem("blog_language_preference");if(e)return e;return(navigator.language||navigator.userLanguage).toLowerCase().startsWith("it")?"it":"en"}function toggleBlogLanguage(){const e="it"===getCurrentBlogLanguage()?"en":"it";localStorage.setItem("blog_language_preference",e),updateLanguageToggleUI(e),loadLatestBlogPosts(e)}function updateLanguageToggleUI(e){const t=document.getElementById("lang-icon"),n=document.getElementById("lang-text");"it"===e?(t.textContent="ðŸ‡®ðŸ‡¹",n.textContent="IT"):(t.textContent="ðŸ‡¬ðŸ‡§",n.textContent="EN")}async function loadLatestBlogPosts(e=null){const t=e||getCurrentBlogLanguage();updateLanguageToggleUI(t);const n=`blog_posts_${t}_`+(new Date).toDateString(),a=localStorage.getItem(n);if(a)try{return void renderBlogPosts(JSON.parse(a),t)}catch(e){console.warn("Failed to parse cached blog posts:",e),localStorage.removeItem(n)}try{const e="en"===t?"/AndreaBozzo/blog/en/index.json":"/AndreaBozzo/blog/index.json",a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch blog posts");const o=await a.json();localStorage.setItem(n,JSON.stringify(o)),renderBlogPosts(o,t)}catch(e){console.error("Failed to load blog posts:",e),showBlogError(t)}}function renderBlogPosts(e,t){const n=document.getElementById("blog-grid");if(!n||!e||0===e.length)return void showBlogError(t);const a=e.slice(0,2);n.innerHTML=a.map(e=>{const n=formatBlogDate(e.date||"",t),a=extractTags(e);return`\n            <a href="${e.permalink}" class="blog-card" style="text-decoration: none; color: inherit;">\n                <div class="blog-date">${escapeHtml(n)}</div>\n                <div class="blog-title">${escapeHtml(e.title)}</div>\n                <div class="blog-summary">${escapeHtml(e.summary)}</div>\n                <div class="blog-tags">\n                    ${a.map(e=>`<span class="blog-tag">${escapeHtml(e)}</span>`).join("")}\n                </div>\n            </a>\n        `}).join("")}function showBlogError(e){const t="it"===e?"Nessun articolo disponibile al momento.":"No articles available at the moment.";document.getElementById("blog-grid").innerHTML=`\n        <div class="blog-card" style="text-align: center; padding: 3rem;">\n            <div class="blog-title">${t}</div>\n        </div>\n    `}function formatBlogDate(e,t){if(!e)return"it"===t?"Recente":"Recent";try{const n=new Date(e),a={year:"numeric",month:"long",day:"numeric"},o="it"===t?"it-IT":"en-US";return n.toLocaleDateString(o,a)}catch(t){return e}}function extractTags(e){if(e.tags&&Array.isArray(e.tags))return e.tags.slice(0,4);const t=[],n=(e.content||e.title||"").toLowerCase();return n.includes("rust")&&t.push("Rust"),n.includes("data")&&n.includes("engineer")&&t.push("Data Engineering"),n.includes("streaming")&&t.push("Streaming"),n.includes("iceberg")&&t.push("Apache Iceberg"),t.slice(0,4)}function escapeHtml(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,e=>t[e])}setTimeout(()=>{prefersReducedMotion||(parallaxEnabled=!0)},1e3),document.addEventListener("mousemove",e=>{lastMouseX=e.pageX,lastMouseY=e.pageY,ticking||(requestAnimationFrame(updateParallax),ticking=!0)}),document.addEventListener("mouseleave",()=>{parallaxEnabled&&(hero.style.transform="rotateY(0deg) rotateX(0deg)")}),"serviceWorker"in navigator&&"localhost"!==window.location.hostname&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/AndreaBozzo/sw.js").then(e=>{console.log("âœ… Service Worker registered:",e.scope),setInterval(()=>{e.update()},36e5)}).catch(e=>{console.log("âŒ Service Worker registration failed:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("ðŸ”„ Service Worker updated, reloading..."),window.location.reload()})}),document.addEventListener("DOMContentLoaded",function(){const e=()=>loadGitHubMetrics(),t=()=>loadLatestBlogPosts();"requestIdleCallback"in window?(requestIdleCallback(e),requestIdleCallback(t)):(setTimeout(e,100),setTimeout(t,150)),"localhost"!==window.location.hostname&&console.log("ðŸ“Š Landing Page Analytics:",{timestamp:(new Date).toISOString(),page:"landing-page",referrer:document.referrer,screen:screen.width+"x"+screen.height})});