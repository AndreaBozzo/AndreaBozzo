<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrea Bozzo - Data Engineer & Software Developer</title>
    <meta name="description" content="Data Engineer specializing in analytics, ETL pipelines, and scalable data solutions. Building elegant solutions to complex data challenges.">
    <meta name="keywords" content="data engineer, analytics, ETL, Python, Rust, Go, data architecture, software development">
    <meta name="author" content="Andrea Bozzo">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#0d1117">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://andreabozzo.github.io/AndreaBozzo/">
    <meta property="og:title" content="Andrea Bozzo - Data Engineer & Software Developer">
    <meta property="og:description" content="Data Engineer specializing in analytics, ETL pipelines, and scalable data solutions.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://andreabozzo.github.io/AndreaBozzo/">
    <meta property="twitter:title" content="Andrea Bozzo - Data Engineer & Software Developer">
    <meta property="twitter:description" content="Data Engineer specializing in analytics, ETL pipelines, and scalable data solutions.">

    <!-- Performance optimizations -->
    <link rel="preconnect" href="https://api.github.com" crossorigin>
    <link rel="dns-prefetch" href="//api.github.com">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='40'>AB</text></svg>">
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <!-- Custom Cursor -->
    <div class="cursor"></div>
    <div class="cursor-follower"></div>

    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Particles Canvas -->
    <canvas id="particles-canvas"></canvas>

    <!-- Theme Toggle -->
    <div class="theme-toggle" onclick="toggleTheme()">
        <span class="theme-toggle-icon" id="theme-icon">üåô</span>
    </div>

    <!-- Floating Action Button -->
    <a href="mailto:andreabozzo92@gmail.com" class="fab" title="Contact Me">
        ‚úâÔ∏è
    </a>

    <!-- Main Content -->
    <div class="content-wrapper">
        <!-- Hero Section -->
        <section class="hero" id="home">
            <div class="hero-content">
                <div class="logo fade-in">AB</div>
                <h1 class="title fade-in fade-in-delay-1">Andrea Bozzo</h1>
                <p class="subtitle fade-in fade-in-delay-2">Data Engineer | Software Developer | Analytics Architect</p>
                <p class="tagline fade-in fade-in-delay-3">
                    Usually trying not to set the database on fire while building scalable data solutions. In my spare time I explore systems programming with Rust & Go. <em>(Coffee consumption not to scale)</em>
                </p>

                <!-- Live Metrics -->
                <div class="metrics fade-in fade-in-delay-3">
                    <div class="metric" id="commits-metric">
                        <span class="metric-value loading" id="commits-count">...</span>
                        <span class="metric-label">Total Commits</span>
                    </div>
                    <div class="metric" id="repos-metric">
                        <span class="metric-value loading" id="repos-count">...</span>
                        <span class="metric-label">Public Repos</span>
                    </div>
                    <div class="metric" id="stars-metric">
                        <span class="metric-value loading" id="stars-count">...</span>
                        <span class="metric-label">Stars Earned</span>
                    </div>
                    <div class="metric">
                        <span class="metric-value">‚àû</span>
                        <span class="metric-label">Lines of Code</span>
                    </div>
                </div>

                <!-- CTA Buttons -->
                <div class="cta-buttons fade-in fade-in-delay-3">
                    <a href="/AndreaBozzo/blog/" class="btn btn-primary">
                        üìù Read My Blog
                    </a>
                    <a href="https://github.com/AndreaBozzo" class="btn btn-secondary">
                        üíª GitHub Profile
                    </a>
                    <a href="https://www.linkedin.com/in/andrea-bozzo-/" class="btn btn-secondary">
                        üíº LinkedIn
                    </a>
                    <a href="mailto:andreabozzo92@gmail.com" class="btn btn-secondary">
                        üìß Get in Touch
                    </a>
                </div>
            </div>
        </section>

        <!-- Tech Stack Section -->
        <section class="tech-stack scroll-reveal" id="tech">
            <h2 class="section-title">Tech Stack</h2>
            <div class="tech-grid">
                <div class="tech-item"><div class="tech-icon">ü¶Ä</div><div class="tech-name">Rust</div></div>
                <div class="tech-item"><div class="tech-icon">üêπ</div><div class="tech-name">Go</div></div>
                <div class="tech-item"><div class="tech-icon">üêç</div><div class="tech-name">Python</div></div>
                <div class="tech-item"><div class="tech-icon">üìú</div><div class="tech-name">JavaScript</div></div>
                <div class="tech-item"><div class="tech-icon">‚ö°</div><div class="tech-name">Apache Spark</div></div>
                <div class="tech-item"><div class="tech-icon">üåä</div><div class="tech-name">Apache Kafka</div></div>
                <div class="tech-item"><div class="tech-icon">üìä</div><div class="tech-name">DuckDB</div></div>
                <div class="tech-item"><div class="tech-icon">üåÄ</div><div class="tech-name">RisingWave</div></div>
                <div class="tech-item"><div class="tech-icon">üêò</div><div class="tech-name">PostgreSQL</div></div>
                <div class="tech-item"><div class="tech-icon">üçÉ</div><div class="tech-name">MongoDB</div></div>
                <div class="tech-item"><div class="tech-icon">‚öôÔ∏è</div><div class="tech-name">Redis</div></div>
                <div class="tech-item"><div class="tech-icon">üìà</div><div class="tech-name">Power BI</div></div>
                <div class="tech-item"><div class="tech-icon">üß±</div><div class="tech-name">Databricks</div></div>
                <div class="tech-item"><div class="tech-icon">üìâ</div><div class="tech-name">Superset</div></div>
                <div class="tech-item"><div class="tech-icon">üê≥</div><div class="tech-name">Docker</div></div>
                <div class="tech-item"><div class="tech-icon">‚ò∏Ô∏è</div><div class="tech-name">Kubernetes</div></div>
                <div class="tech-item"><div class="tech-icon">‚òÅÔ∏è</div><div class="tech-name">AWS</div></div>
                <div class="tech-item"><div class="tech-icon">üî∑</div><div class="tech-name">Azure</div></div>
                <div class="tech-item"><div class="tech-icon">üîÑ</div><div class="tech-name">GitHub Actions</div></div>
            </div>
        </section>

        <!-- Blog Preview Section -->
        <section class="blog-preview scroll-reveal" id="blog">
            <h2 class="section-title">Latest from the Blog</h2>
            <div class="blog-grid" id="blog-grid">
                <!-- Blog posts will be loaded dynamically -->
                <a href="/AndreaBozzo/blog/posts/iceberg-risingwave-blog/" class="blog-card" style="text-decoration: none; color: inherit;">
                    <div class="blog-date">November 10, 2025</div>
                    <div class="blog-title">RisingWave e Iceberg-Rust: Real-Time Streaming Meets Modern Data Lake</div>
                    <div class="blog-summary">How RisingWave and Apache Iceberg Rust are revolutionizing modern data lakehouse architecture with real-time streaming CDC and intelligent hybrid delete strategies.</div>
                    <div class="blog-tags">
                        <span class="blog-tag">Rust</span>
                        <span class="blog-tag">Data Engineering</span>
                        <span class="blog-tag">Streaming</span>
                    </div>
                </a>
            </div>
            <div style="text-align: center; margin-top: 3rem;">
                <a href="/AndreaBozzo/blog/" class="btn btn-primary">View All Posts ‚Üí</a>
            </div>
        </section>

        <!-- Projects Section -->
        <section class="projects scroll-reveal" id="projects">
            <h2 class="section-title">Featured Open Source Contributions</h2>
            <div class="projects-grid">
                <div class="project-card">
                    <div class="project-image">üçï</div>
                    <div class="project-content">
                        <h3 class="project-title">DataPizza AI</h3>
                        <p class="project-desc">Build reliable Gen AI solutions without overhead. 3 merged PRs contributing to a tool for practical AI implementation. ‚≠ê 1.9k stars</p>
                        <div class="project-tech">
                            <span class="project-tech-item">AI/ML</span>
                            <span class="project-tech-item">Python</span>
                            <span class="project-tech-item">Gen AI</span>
                        </div>
                    </div>
                </div>
                <div class="project-card">
                    <div class="project-image">ü¶Ä</div>
                    <div class="project-content">
                        <h3 class="project-title">RisingWave & Rust Ecosystem</h3>
                        <p class="project-desc">Contributing to RisingWave streaming database and Rust documentation translation. Building high-performance data pipelines with Rust.</p>
                        <div class="project-tech">
                            <span class="project-tech-item">Rust</span>
                            <span class="project-tech-item">Streaming</span>
                            <span class="project-tech-item">Documentation</span>
                        </div>
                    </div>
                </div>
                <div class="project-card">
                    <div class="project-image">üß†</div>
                    <div class="project-content">
                        <h3 class="project-title">CortexBrain</h3>
                        <p class="project-desc">Intelligent service mesh architecture connecting cloud and edge devices. 3 merged PRs for distributed systems. ‚≠ê 67 stars</p>
                        <div class="project-tech">
                            <span class="project-tech-item">Edge Computing</span>
                            <span class="project-tech-item">Service Mesh</span>
                            <span class="project-tech-item">Distributed Systems</span>
                        </div>
                    </div>
                </div>
                <div class="project-card">
                    <div class="project-image">üìä</div>
                    <div class="project-content">
                        <h3 class="project-title">Data Lakehouse Architecture</h3>
                        <p class="project-desc">Building modern data lakehouse solutions with Apache Iceberg, DuckDB, and streaming pipelines for real-time analytics at scale.</p>
                        <div class="project-tech">
                            <span class="project-tech-item">Iceberg</span>
                            <span class="project-tech-item">DuckDB</span>
                            <span class="project-tech-item">Python</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features scroll-reveal">
            <div class="features-grid">
                <div class="feature-card">
                    <span class="feature-icon">DATA</span>
                    <h3 class="feature-title">Data Engineering</h3>
                    <p class="feature-desc">
                        Designing and implementing robust ETL pipelines, data warehouses, and analytics platforms. Expertise in modern data stack technologies, streaming systems, and lakehouse architectures.
                    </p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">ARCH</span>
                    <h3 class="feature-title">System Architecture</h3>
                    <p class="feature-desc">
                        Building scalable, high-performance systems with optimized data modeling. Experience with distributed systems, cloud infrastructure, and real-time processing.
                    </p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">CODE</span>
                    <h3 class="feature-title">Software Development</h3>
                    <p class="feature-desc">
                        Creating clean, maintainable code in Rust, Go, and Python. Strong focus on performance, testing, documentation, and collaborative development workflows.
                    </p>
                </div>
            </div>
        </section>

        <!-- Social Proof -->
        <section class="social-proof scroll-reveal">
            <h2 class="social-proof-title">Let's Connect</h2>
            <p class="social-proof-text">
                Currently exploring systems programming with Rust and Go.<br>
                Always interested in discussing new opportunities, collaborations, and innovative data challenges.
            </p>

            <div class="social-links">
                <a href="https://github.com/AndreaBozzo" class="social-link">
                    üíª GitHub
                </a>
                <a href="https://www.linkedin.com/in/andrea-bozzo-/" class="social-link">
                    üíº LinkedIn
                </a>
                <a href="/AndreaBozzo/blog/" class="social-link">
                    üìù Blog
                </a>
                <a href="mailto:andreabozzo92@gmail.com" class="social-link">
                    üìß Email
                </a>
            </div>
        </section>
    </div>

    <script>
        // ===== Theme Toggle =====
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.getElementById('theme-icon').textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';

        // ===== Custom Cursor =====
        const cursor = document.querySelector('.cursor');
        const cursorFollower = document.querySelector('.cursor-follower');

        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';

            setTimeout(() => {
                cursorFollower.style.left = e.clientX + 'px';
                cursorFollower.style.top = e.clientY + 'px';
            }, 100);
        });

        document.querySelectorAll('a, button, .btn, .tech-item, .blog-card, .project-card').forEach(el => {
            el.addEventListener('mouseenter', () => cursor.classList.add('active'));
            el.addEventListener('mouseleave', () => cursor.classList.remove('active'));
        });

        // ===== Particles Animation =====
        const canvas = document.getElementById('particles-canvas');
        const ctx = canvas.getContext('2d', { alpha: true, desynchronized: true });
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];
        // Riduce particelle su mobile per performance
        const particleCount = window.innerWidth < 768 ? 30 : 45;

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.radius = Math.random() * 2 + 1;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;

                if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }

            draw() {
                ctx.fillStyle = 'rgba(88, 166, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle());
        }

        let lastFrameTime = 0;
        const targetFPS = 60;
        const frameInterval = 1000 / targetFPS;
        const maxDistance = 120;
        const maxDistanceSquared = maxDistance * maxDistance; // Avoid sqrt by comparing squared distances
        let isCanvasVisible = true;
        let animationId = null;

        function animateParticles(currentTime) {
            if (!isCanvasVisible) return; // Stop if not visible

            // Throttle animation to target FPS
            if (currentTime - lastFrameTime < frameInterval) {
                animationId = requestAnimationFrame(animateParticles);
                return;
            }
            lastFrameTime = currentTime;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update all particles first
            particles.forEach(particle => particle.update());

            // Draw connections (optimized with squared distance)
            ctx.lineWidth = 0.5;
            for (let i = 0; i < particles.length; i++) {
                const particle = particles[i];

                // Limit connections per particle for better performance
                let connectionsDrawn = 0;
                const maxConnectionsPerParticle = 5;

                for (let j = i + 1; j < particles.length && connectionsDrawn < maxConnectionsPerParticle; j++) {
                    const otherParticle = particles[j];
                    const dx = particle.x - otherParticle.x;
                    const dy = particle.y - otherParticle.y;

                    // Quick rejection test with absolute values
                    if (Math.abs(dx) > maxDistance || Math.abs(dy) > maxDistance) continue;

                    // Use squared distance to avoid expensive sqrt
                    const distanceSquared = dx * dx + dy * dy;

                    if (distanceSquared < maxDistanceSquared) {
                        const distance = Math.sqrt(distanceSquared); // Only calculate sqrt when needed
                        const opacity = 0.2 * (1 - distance / maxDistance);
                        ctx.strokeStyle = `rgba(88, 166, 255, ${opacity})`;
                        ctx.beginPath();
                        ctx.moveTo(particle.x, particle.y);
                        ctx.lineTo(otherParticle.x, otherParticle.y);
                        ctx.stroke();
                        connectionsDrawn++;
                    }
                }
            }

            // Draw particles after connections (so they appear on top)
            ctx.fillStyle = 'rgba(88, 166, 255, 0.3)';
            particles.forEach(particle => particle.draw());

            animationId = requestAnimationFrame(animateParticles);
        }

        // Pause animation when canvas is not in viewport
        function startAnimation() {
            if (!isCanvasVisible || animationId) return;
            lastFrameTime = performance.now(); // Reset frame time
            animationId = requestAnimationFrame(animateParticles);
        }

        function stopAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
        }

        // Observe canvas visibility
        if ('IntersectionObserver' in window) {
            const canvasObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    isCanvasVisible = entry.isIntersecting;
                    if (isCanvasVisible) {
                        startAnimation();
                    } else {
                        stopAnimation();
                    }
                });
            }, {
                threshold: 0.01 // Start animation when even 1% is visible
            });

            canvasObserver.observe(canvas);
        }

        startAnimation();

        // Debounce resize event
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }, 150);
        });

        // ===== Scroll Reveal Animation with Intersection Observer =====
        const revealElements = document.querySelectorAll('.scroll-reveal');

        // Use Intersection Observer for better performance
        if ('IntersectionObserver' in window) {
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                        revealObserver.unobserve(entry.target); // Stop observing once revealed
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -100px 0px'
            });

            revealElements.forEach(el => revealObserver.observe(el));
        } else {
            // Fallback for older browsers
            const revealOnScroll = () => {
                revealElements.forEach(el => {
                    const rect = el.getBoundingClientRect();
                    if (rect.top < window.innerHeight - 100) {
                        el.classList.add('revealed');
                    }
                });
            };
            window.addEventListener('scroll', revealOnScroll, { passive: true });
            revealOnScroll();
        }

        // ===== GitHub API Integration =====
        async function loadGitHubMetrics() {
            const cacheKey = 'github_metrics';
            const cacheTimestampKey = 'github_metrics_timestamp';
            const cached = localStorage.getItem(cacheKey);
            const cacheTimestamp = localStorage.getItem(cacheTimestampKey);

            // Check if cache is valid (less than 24 hours old)
            const now = Date.now();
            const cacheAge = cacheTimestamp ? now - parseInt(cacheTimestamp) : Infinity;
            const cacheMaxAge = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

            if (cached && cacheAge < cacheMaxAge) {
                try {
                    const data = JSON.parse(cached);
                    updateMetrics(data);
                    return;
                } catch (e) {
                    console.warn('Failed to parse cached GitHub metrics:', e);
                    localStorage.removeItem(cacheKey);
                    localStorage.removeItem(cacheTimestampKey);
                }
            }

            try {
                const username = 'AndreaBozzo';

                const [userResponse, reposResponse] = await Promise.all([
                    fetch(`https://api.github.com/users/${username}`),
                    fetch(`https://api.github.com/users/${username}/repos?per_page=100&sort=updated`)
                ]);

                const [userData, reposData] = await Promise.all([
                    userResponse.json(),
                    reposResponse.json()
                ]);

                const totalStars = reposData.reduce((sum, repo) => sum + repo.stargazers_count, 0);
                const publicRepos = userData.public_repos;
                const estimatedCommits = Math.max(publicRepos * 50, 500);

                const metrics = { commits: estimatedCommits, repos: publicRepos, stars: totalStars };

                localStorage.setItem(cacheKey, JSON.stringify(metrics));
                localStorage.setItem(cacheTimestampKey, now.toString());
                updateMetrics(metrics);

            } catch (error) {
                console.log('GitHub API error:', error);
                updateMetrics({ commits: 500, repos: 15, stars: 50 });
            }
        }

        function updateMetrics(data) {
            const elements = ['commits-count', 'repos-count', 'stars-count'];
            const values = [data.commits, data.repos, data.stars];

            elements.forEach((id, index) => {
                const el = document.getElementById(id);
                el.classList.remove('loading');
                animateCounter(id, values[index]);
            });
        }

        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            const duration = 2000;
            const stepTime = 50;
            const steps = duration / stepTime;
            const increment = targetValue / steps;
            let current = 0;

            const timer = setInterval(() => {
                current += increment;
                if (current >= targetValue) {
                    current = targetValue;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current).toLocaleString();
            }, stepTime);
        }

        // ===== 3D Parallax Effect on Hero (Throttled for performance) =====
        const hero = document.querySelector('.hero-content');
        let parallaxEnabled = false;
        let ticking = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        // Enable parallax only after initial animations complete
        setTimeout(() => {
            parallaxEnabled = true;
        }, 1000);

        function updateParallax() {
            if (!parallaxEnabled || window.innerWidth <= 768) return;

            const xAxis = (window.innerWidth / 2 - lastMouseX) / 100;
            const yAxis = (window.innerHeight / 2 - lastMouseY) / 100;

            const maxRotation = 5;
            const clampedX = Math.max(-maxRotation, Math.min(maxRotation, xAxis));
            const clampedY = Math.max(-maxRotation, Math.min(maxRotation, yAxis));

            hero.style.transform = `rotateY(${clampedX}deg) rotateX(${clampedY}deg)`;
            ticking = false;
        }

        document.addEventListener('mousemove', (e) => {
            lastMouseX = e.pageX;
            lastMouseY = e.pageY;

            if (!ticking) {
                requestAnimationFrame(updateParallax);
                ticking = true;
            }
        });

        document.addEventListener('mouseleave', () => {
            if (parallaxEnabled) {
                hero.style.transform = 'rotateY(0deg) rotateX(0deg)';
            }
        });

        // ===== Blog Posts Auto-Loading =====
        async function loadLatestBlogPosts() {
            // Detect user language (prefer Italian, fallback to English)
            const userLang = (navigator.language || navigator.userLanguage).toLowerCase();
            const isItalian = userLang.startsWith('it');
            const lang = isItalian ? 'it' : 'en';

            const cacheKey = `blog_posts_${lang}_` + new Date().toDateString();
            const cached = localStorage.getItem(cacheKey);

            if (cached) {
                try {
                    const posts = JSON.parse(cached);
                    renderBlogPosts(posts);
                    return;
                } catch (e) {
                    console.warn('Failed to parse cached blog posts:', e);
                    localStorage.removeItem(cacheKey);
                }
            }

            try {
                // Try language-specific JSON first, fallback to default (Italian)
                const blogJsonPath = lang === 'en'
                    ? '/AndreaBozzo/blog/en/index.json'
                    : '/AndreaBozzo/blog/index.json';

                const response = await fetch(blogJsonPath);
                if (!response.ok) {
                    // If language-specific JSON fails, try fallback to Italian
                    if (lang === 'en') {
                        const fallbackResponse = await fetch('/AndreaBozzo/blog/index.json');
                        if (!fallbackResponse.ok) throw new Error('Failed to fetch blog posts');
                        const posts = await fallbackResponse.json();
                        localStorage.setItem(cacheKey, JSON.stringify(posts));
                        renderBlogPosts(posts);
                        return;
                    }
                    throw new Error('Failed to fetch blog posts');
                }

                const posts = await response.json();
                localStorage.setItem(cacheKey, JSON.stringify(posts));
                renderBlogPosts(posts);
            } catch (error) {
                console.error('Failed to load blog posts:', error);
                // Keep hardcoded fallback in HTML
            }
        }

        function renderBlogPosts(posts) {
            const blogGrid = document.getElementById('blog-grid');
            if (!blogGrid || !posts || posts.length === 0) {
                console.warn('Blog rendering skipped:', { blogGrid: !!blogGrid, posts: posts?.length });
                return;
            }

            const latestPosts = posts.slice(0, 3); // Show 3 latest posts
            console.log('Rendering', latestPosts.length, 'blog posts');

            blogGrid.innerHTML = latestPosts.map(post => {
                const date = formatBlogDate(post.date || '');
                const tags = extractTags(post);

                return `
                    <a href="${post.permalink}" class="blog-card" style="text-decoration: none; color: inherit;">
                        <div class="blog-date">${date}</div>
                        <div class="blog-title">${escapeHtml(post.title)}</div>
                        <div class="blog-summary">${escapeHtml(post.summary)}</div>
                        <div class="blog-tags">
                            ${tags.map(tag => `<span class="blog-tag">${escapeHtml(tag)}</span>`).join('')}
                        </div>
                    </a>
                `;
            }).join('');
        }

        function formatBlogDate(dateString) {
            if (!dateString) return 'Recent';

            try {
                const date = new Date(dateString);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return date.toLocaleDateString('en-US', options);
            } catch (e) {
                return dateString;
            }
        }

        function extractTags(post) {
            // Try to extract tags from various possible locations
            if (post.tags && Array.isArray(post.tags)) {
                return post.tags.slice(0, 4); // Max 4 tags
            }

            // Fallback: extract from content or title
            const defaultTags = [];
            const content = (post.content || post.title || '').toLowerCase();

            if (content.includes('rust')) defaultTags.push('Rust');
            if (content.includes('data') && content.includes('engineer')) defaultTags.push('Data Engineering');
            if (content.includes('streaming')) defaultTags.push('Streaming');
            if (content.includes('iceberg')) defaultTags.push('Apache Iceberg');

            return defaultTags.slice(0, 4);
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // ===== Initialize =====
        document.addEventListener('DOMContentLoaded', function() {
            const loadMetrics = () => loadGitHubMetrics();
            const loadBlogPosts = () => loadLatestBlogPosts();

            if ('requestIdleCallback' in window) {
                requestIdleCallback(loadMetrics);
                requestIdleCallback(loadBlogPosts);
            } else {
                setTimeout(loadMetrics, 100);
                setTimeout(loadBlogPosts, 150);
            }

            // Analytics
            if (window.location.hostname !== 'localhost') {
                console.log('üìä Landing Page Analytics:', {
                    timestamp: new Date().toISOString(),
                    page: 'landing-page',
                    referrer: document.referrer,
                    screen: screen.width + 'x' + screen.height
                });
            }
        });
    </script>
</body>
</html>
